/*! wikisearch 2017-03-15 */
function wikiRequest(){$.ajax({url:"https://en.wikipedia.org/w/api.php?format=json&action=query&generator=search&gsrnamespace=0&gsrlimit=10&prop=pageimages|extracts&pilimit=max&exintro&explaintext&exsentences=1&exlimit=max&gsrsearch="+searched,dataType:"jsonp",error:function(){console.log("error")},success:function(a){if(a.hasOwnProperty("query")){result=a.query.pages;for(var b in result){var c=result[b],d="";c.hasOwnProperty("thumbnail")&&(d=c.thumbnail.source),$("#result"+c.index).empty().append(renderResult(c.title,c.extract,c.pageid,c.index,d))}}else $('div[id^="result"]').empty(),$("span").text("No results found").show().fadeOut(5e3)}})}function renderResult(a,b,c,d,e){return""==e?'<div class="result" id="'+d+'" onclick="openUrl('+c+')"><h3>'+a+"</h3><br>"+b+"</.div>":'<div class="result" id="'+d+'" onclick="openUrl('+c+')"><h3>'+a+'</h3><img class="thumbnail" src="'+e+'"><br>'+b+"</.div>"}function openUrl(a){window.open("https://en.wikipedia.org/wiki?curid="+a,"_blank")}var date=new Date;date.setDate(date.getDate()-2),date=date.toISOString().slice(0,10).replace(/-/g,"/");var trendsUrl="https://wikimedia.org/api/rest_v1/metrics/pageviews/top/en.wikipedia/all-access/"+date,promiseGetTrends=new Promise(function(a,b){a(fetch(trendsUrl).then(function(a){return a.json()})),b(Error("Error: fetch channel from API failed"))});promiseGetTrends.then(function(a){var b=a.items[0].articles,c=$.map(b,function(a,b){return output=a.article,filtered=output.replace(/\(|\)|_/g," "),[filtered]});return c}).then(function(a){$(function(){$("#search-box").autocomplete({minLength:3,source:a})})}),$("#search").submit(function(a){""!==$("input:first").val()?(searched=$("input:first").val(),searched=searched.replace(/[^a-z0-9 ]/gi,"").trim(),wikiRequest()):$("span").text("Please enter search term").show().fadeOut(5e3),a.preventDefault()}),$("#random").click(function(){window.open("https://wikipedia.org/wiki/Special:Random","_blank")});